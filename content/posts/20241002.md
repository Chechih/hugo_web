---
title: "使用 Web Deploy 發佈程式到 IIS 上"
date: 2024-10-02T17:43:49+08:00
categories: ["Windows", "IIS", "NET", ]
---
### 前言
如果在開發時，部屬的 IIS (下面簡稱 A 電腦)和開發程式 (下面簡稱 B 電腦)是在不同機器上面時，這時就可以使用 Web Deploy 將程式碼從 B 電腦發佈到 A 電腦上面，這樣就能省掉很多的時間!!!  
本範例使用 Windows Server 2022 和 Web Deploy 4.0, 專案市使用 Visual Studio 2022 的 ASP.NET Web 應用程式(Model-View-Controller)，專案名 TestWeb
### 安裝
先到 A 電腦上安裝 Web Deploy 
1. 可以從微軟官網上[下載](https://www.microsoft.com/en-us/download/details.aspx?id=106070&msockid=249a4e66a90668b80d395ad2a8ae69c7)，按下載鍵時，直接選擇 **webdeploy_amd64_zh-TW.msi** 即可  
![20241002_01](/images/20241002/1.jpg "20241002_01")  
2. 安裝時請選擇完整安裝  
![20241002_02](/images/20241002/2.jpg "20241002_02")  
![20241002_03](/images/20241002/3.jpg "20241002_03")  
![20241002_04](/images/20241002/4.jpg "20241002_04")  
![20241002_05](/images/20241002/5.jpg "20241002_05")  
![20241002_06](/images/20241002/6.jpg "20241002_06")  
![20241002_07](/images/20241002/7.jpg "20241002_07")  
3. 安裝完成後，請再點選 EXE 檔案(**webdeploy_amd64_zh-TW.msi**)按下**變更**，將其餘東西也都裝好
![20241002_16](/images/20241002/16.jpg "20241002_16")  
### 設定功能
A 電腦上設定
1. 打開**伺服器管理員**
![20241002_08](/images/20241002/8.jpg "20241002_08")  
2. 點選**新增角色及功能**
3. 到**伺服器角色**那頁，勾選**網頁伺服器中的**管理服務**，安裝他
![20241002_09](/images/20241002/9.jpg "20241002_09")  
### IIS 設定
A 電腦上設定
1. 打開 IIS
2. 點選**管理服務**
![20241002_10](/images/20241002/10.jpg "20241002_10")  
3. 勾選**遠端連線**，並按下右方的啟動
![20241002_11](/images/20241002/11.jpg "20241002_11")  
### 測試
打開 B 電腦的 Visual Studio 2022 和專案
1. 點選專案右鍵，並選擇發佈
![20241002_12](/images/20241002/12.jpg "20241002_12")  
2. 選擇**網頁伺服器(IIS)**
![20241002_13](/images/20241002/13.jpg "20241002_13")  
3. 選擇**Web Deploy**
![20241002_14](/images/20241002/14.jpg "20241002_14")  
4. 輸入 IIS 訊息  
    a. 伺服器 --> A 電腦 IP
    b. 網站名稱 --> A 電腦 IIS 名稱
    c. 目的地 URL --> IIS URL
    d. 使用者名稱密碼 --> A 電腦的使用者
![20241002_15](/images/20241002/15.jpg "20241002_15")  
5. 點選發佈  
![20241002_17](/images/20241002/17.jpg "20241002_17")  
6. 會看到網頁跳出，即成功了!!!
![20241002_18](/images/20241002/18.jpg "20241002_18")  
7. 如果中途有出現甚麼問題，可以檢查或關閉下 A 電腦的防火牆，或重新啟動

### 參考
- [Visual Studio使用Web Deploy发布.NET Web应用到指定服务器的IIS中](https://www.cnblogs.com/Can-daydayup/p/17900076.html)  
- [MVCNF11-網站發行](https://hackmd.io/@johnsonnote/webdesign/https%3A%2F%2Fhackmd.io%2F%40johnsonnote%2Ffw_deploy)  