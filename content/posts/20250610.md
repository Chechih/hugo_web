---
title: "Docker ç‰ˆ Minikube Port å•é¡Œæ•´ç†"
date: 2025-06-09T22:39:11+08:00
categories: ["Minikube" ]
---
### å‰è¨€
åœ¨ä½¿ç”¨ Docker Driver çš„ Minikube æ¸¬è©¦æ™‚ï¼Œå¸¸æœƒé‡åˆ°å¹¾å€‹å•é¡Œ:
- æ˜æ˜æœ‰å»ºç«‹ Serviceï¼Œå»ç„¡æ³•é€£ç·š
- Kubernetes Cluster çš„ 8443 port ç„¡æ³•å¾å¤–éƒ¨å­˜å–
- ç„¡æ³•å¾ Harbor æ‹‰å– image
ä»¥ä¸‹æ˜¯æˆ‘æ¸¬è©¦éçš„è§£æ³•æ•´ç†ã€‚

### ç„¡æ³•é€£ç·šåˆ° Kubernetes Cluster(Port 8443)
1. æŸ¥çœ‹ Cluster è³‡è¨Š:  
```shell
kubectl cluster-info
```
![Minikube Info](/images/20250610/1.jpg "minikube_info")  
â†’ å¯çœ‹åˆ° API Server åœ¨ *https://192.168.49.2:8443*
2. å³ä½¿ `ping 192.168.49.2` é€šï¼Œä¹Ÿåªèƒ½åœ¨æœ¬æ©Ÿé€šï¼Œå…¶ä»–é›»è…¦ç„¡æ³•å­˜å–ï¼Œå› ç‚ºé€™æ˜¯ Container å…§éƒ¨ IPã€‚
3. è§£æ³•: ä½¿ç”¨ `docker ps` æŸ¥çœ‹ Minikube Container æ˜¯å¦æœ‰å°‡ 8443 port æ˜ å°„å‡ºä¾†: 
```shell
docker ps
```
![Docker Minikube Port](/images/20250610/2.jpg "docker_minikube_port")  
ç¢ºèª 8443 æ˜¯å¦æœ‰å°æ‡‰å‡ºä¾†çµ¦ Host

### Service å»ºç«‹å¾Œä»ç„¡æ³•é€£ç·šï¼Ÿ
- å•é¡Œ: Docker Driver ä¸æœƒè‡ªå‹•æŠŠ Minikube Container çš„ Port æ˜ å°„å‡ºä¾†
- è§£æ³•: åŠ ä¸Š --ports åƒæ•¸é–‹æ”¾å°æ‡‰ port
```shell
minikube start --driver=docker --ports=<url>:<port>: <target_port>
# ex:
# minikube start --driver=docker --ports=0.0.0.0:8443:8443
# æ”¯æ´å¤šå€‹ portï¼Œä¾‹å¦‚:  
# minikube start --driver=docker --ports=0.0.0.0:8443:8443 --ports=0.0.0.0:8086:30001 --ports=0.0.0.0:8087:30002 --ports=0.0.0.0:8088:30003 --ports=0.0.0.0:8089:30004 --ports=0.0.0.0:443:443
```
ğŸ“Œ æ³¨æ„ï¼ æ”¹é --ports å¾Œè¦é‡å»º Minikube:
```shell
minikube delete
# åˆªé™¤ç¾æœ‰ Minikube è¨­å®šï¼Œé€™å€‹æˆ–è¨±ä¸ç”¨ï¼Œåæ­£å¾Œé¢éƒ½æœƒä¸è¦‹...
minikube stop
# åœæ­¢ Minikube
docker ps -a
# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨
docker rm <minikube_container_id>
# åˆªé™¤ Minikube å®¹å™¨
docker images
# æŸ¥çœ‹æ‰€æœ‰æ˜ åƒ
docker rmi <minikube_image_id>
# åˆªé™¤ Minikube æ˜ åƒ
```

#### Service å¯«æ³•å»ºè­°(NodePort)
ç‚ºäº†è®“å¤–éƒ¨èƒ½ç©©å®šé€£é€²ä¾†ï¼Œå»ºè­°ä½¿ç”¨ NodePort ä¸¦æ˜ç¢ºæŒ‡å®š nodePort:  
Ex:  
```yaml
apiVersion: v1
kind: Service
metadata:
  name: demo-app
spec:
  type: NodePort
  ports:
    - port: 8080
      targetPort: 80
      nodePort: 30001
  selector:
    k8s-app: demo-app
```
æŸ¥è©¢å¯¦éš›ç¶²å€èˆ‡ port å¯ä½¿ç”¨: 
```shell
minikube service <service_name>
```

### Harbor ç„¡æ³•æ‹‰å– Image?
é€™æ˜¯å› ç‚ºç§æœ‰ Registry æ²’æœ‰ä½¿ç”¨ HTTPSï¼ŒåŠ ä¸Šé è¨­æ‹’çµ• HTTP é€£ç·šã€‚
è§£æ³•: åŠ ä¸Š --insecure-registry åƒæ•¸
```shell
minikube start --driver=docker --insecure-registry=<url_paths>
# ex:
# minikube start --driver=docker --insecure-registry="192.168.49.2:5000,harbor.example.com:80"'
```
- *192.168.49.2* æ˜¯ Minikube IP(ç”¨ minikube ip å¯æŸ¥)
- *5000* æ˜¯ä½ æœ¬æ©Ÿé–‹çš„ Docker Registry é è¨­ port
- *harbor.example.com:80* å‰‡æ˜¯ä½ è¦æ‹‰å– Image çš„ç§æœ‰å€‰å„²
é€™æ¨£å°±èƒ½å¾ç§æœ‰ Registry æˆ– Harbor æ‹‰å– Image äº†ã€‚

### åƒè€ƒ
- [Cannot access deployed services when Minikube cluster is installed in WSL2](https://stackoverflow.com/questions/71384252/cannot-access-deployed-services-when-minikube-cluster-is-installed-in-wsl2) 
- [Expose port in minikube [closed]](https://stackoverflow.com/questions/40767164/expose-port-in-minikube) 
- [how to configure minikube to use docker private registry](https://stackoverflow.com/questions/57192259/how-to-configure-minikube-to-use-docker-private-registry) 